The enclave's identity can be checked from the following elements:

- Intel SGX quote generated by the enclave to attest the code is running in an Intel SGX enclave (can be checked with Azure remote attestation or Intel remote attestation service), it includes:
   - MRENCLAVE, a SHA-256 digest of the whole program loaded in memory
   - MRSIGNER, a SHA-256 digest of Cosmian's RSA public key which signs the enclave
- Enclave's public key (SHA-256 digest can be found in the report data field of the quote)
- TOML manifest with the hash of all the files loaded in the enclave, including:
    - serialized trusted args of the code which contains a list of participant's public keys
    - hash digest of the entrypoint `run.py`

Everything should be verified to trust that Cosmian is running the computation inside an Intel SGX enclave:

- Audit source code of `cosmian_lib_sgx` to see how enclave's public key is included in the SGX quote. We generate a random key pair whose seed is specific to MRENCLAVE (Seal Key with Intel SGX instruction EGETKEY based on MRENCLAVE). If the Python code or any participant's key changes, MRENCLAVE will also be modified
- Re-compute MRSIGNER with Cosmian's RSA public key
- And finally you can re-compute MRENCLAVE with the same docker used in the execution (will be available soon) thanks to manifest and the Python code of the code provider
